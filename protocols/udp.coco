version 1.0
endian be

include "dns.coco"

// ============================================================================
// UDP Protocol (RFC 768)
// ============================================================================

// UDP datagram (RFC 768)
layer message udp_datagram {
  u16 src_port [display: port]
  u16 dst_port [display: port]
  u16 length
  u16 checksum
  bytes data[length - 8] match dst_port {
    53 -> dns_message dns
    _ -> {}
  }
}
